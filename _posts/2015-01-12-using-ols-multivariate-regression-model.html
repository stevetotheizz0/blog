---
layout: post
title: Predicting Home Prices Using Multivariate Statistical Analysis
date: '2015-01-12T09:56:00.000-08:00'
author: Stephen Skilton
tags:
- ArcMap
- OLS
- R
- Statistics
modified_time: '2015-01-12T09:58:40.172-08:00'
thumbnail: /img/01-12-2015.png
blogger_id: tag:blogger.com,1999:blog-8702082509687900611.post-660601012838108332
blogger_orig_url: http://thenewphiladelphian.blogspot.com/2015/01/using-ols-multivariate-regression-model.html
---

<div class="MsoNormal">Over the fall I created an OLS regression model as an exercise in R. &nbsp;The model was built using a kitchen sink approach where you basically just throw in a ton of variables without any underlying theory and see which are statistically significant. Of course this approach will only give you results based on correlation and without an underlying theory this would not be a good way to create a model for actual prediction in the real world. &nbsp;However it is a great way to practice R and go through the exercise of creating a statistical model.</div><div class="MsoNormal"><br /></div><div class="MsoNormal">Most of the variable data, such as demographics and income, was obtained from the most recent census. Home sale prices were geocoded and joined to variable data in GIS often by census tract or distance.</div><div class="MsoNormal"><br /></div><div class="MsoNormal">Other variables were also imported through various methods. &nbsp;Examples included geocoded Wikipedia articles obtained through an API, the location of street trees in Philadelphia, voter turnout, and test scores of local schools. &nbsp;A near table was generated in GIS for each home sale price entry that displayed the count and distance of homes from each variable point. &nbsp;So for example, the total number of trees within 100 ft of a home could be calculated and summed.</div><div class="MsoNormal"><br /></div><div class="MsoNormal">Below are a few maps, the first of which shows the location of home sale prices used to train and later test the model. &nbsp;The other maps depict some of the variables joined to home sale prices that proved to be statistically significant within the model.</div><div class="MsoNormal"><br /></div><div class="MsoNormal"><br /></div><div class="MsoNormal"><br /></div><div class="separator" style="clear: both; text-align: center;"><a target="_blank" href="http://4.bp.blogspot.com/-7qxOq-YLp2Y/VLLvpKnr-II/AAAAAAAABMc/BMiWjUyY6YE/s1600/map1.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-7qxOq-YLp2Y/VLLvpKnr-II/AAAAAAAABMc/BMiWjUyY6YE/s1600/map1.jpg" height="400" width="308" /></a></div><br /><div class="separator" style="clear: both; text-align: center;"><a target="_blank" href="http://1.bp.blogspot.com/-aajem8eNpDs/VLLvsgREebI/AAAAAAAABMk/z55LAq_qiCg/s1600/map2.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-aajem8eNpDs/VLLvsgREebI/AAAAAAAABMk/z55LAq_qiCg/s1600/map2.jpg" height="400" width="308" /></a></div><div class="MsoNormal"><br /></div><div class="MsoNormal"><br /></div><div class="MsoNormal"><br /></div><div class="MsoNormal"><o:p></o:p></div><div class="MsoNormal"><br /></div><div class="MsoNormal">As you might have guessed, I found that the distance of a home from Wikipedia articles did not happen to be a significant predictor of home sale prices. However voter turnout in an area was a significant factor. &nbsp;The total number of votes explains something about the value of homes in an area different from all the other qualities. &nbsp;Surprisingly, although trees are said to improve the value of a home or block, the model did not identify this variable as being statistically significant.<o:p></o:p></div><div class="MsoNormal"><br /></div><div class="MsoNormal">Below is a correlation matrix that can be used to visualize the relationship of each of the significant variables I identified in my final model with Sale Price:<o:p></o:p></div><div class="MsoNormal"><br /></div><div class="separator" style="clear: both; text-align: center;"><a target="_blank" href="http://1.bp.blogspot.com/-9_JZR21YJfw/VLLmLRhKF4I/AAAAAAAABLQ/-EsBqIkPbaA/s1600/Rplot.jpeg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-9_JZR21YJfw/VLLmLRhKF4I/AAAAAAAABLQ/-EsBqIkPbaA/s1600/Rplot.jpeg" height="211" width="320" /></a></div><div class="MsoNormal"><o:p><br /></o:p></div><div class="MsoNormal"><o:p><br /></o:p></div><div class="MsoNormal"><br /></div><div class="MsoNormal"><br /></div><div class="MsoNormal">The resulting the model accurately predicted the sampled home sale prices 52% of the time. &nbsp;When tested with the cross validation tool, which removes a random sample of data the accuracy rate was sustained. &nbsp;Summaries of both are show below.<o:p></o:p></div><div class="MsoNormal"><br /></div><div class="separator" style="clear: both; text-align: center;"><a target="_blank" href="http://2.bp.blogspot.com/-2n77jYIU3R4/VLLqPh2ccvI/AAAAAAAABLk/wxe95DtOBjk/s1600/in-sample.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-2n77jYIU3R4/VLLqPh2ccvI/AAAAAAAABLk/wxe95DtOBjk/s1600/in-sample.png" height="400" width="242" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"><a target="_blank" href="http://3.bp.blogspot.com/-s3PWrDxMcDI/VLLs1Mb22DI/AAAAAAAABMA/f7MtW0P-duQ/s1600/cross-validation.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-s3PWrDxMcDI/VLLs1Mb22DI/AAAAAAAABMA/f7MtW0P-duQ/s1600/cross-validation.png" height="320" width="237" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="MsoNormal"><br /></div><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"><a target="_blank" href="http://2.bp.blogspot.com/-uclFbT_oy8M/VLQHCDDgQAI/AAAAAAAABVA/fct4dOfvrlo/s1600/m.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-uclFbT_oy8M/VLQHCDDgQAI/AAAAAAAABVA/fct4dOfvrlo/s1600/m.png" height="114" width="320" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a target="_blank" href="http://2.bp.blogspot.com/-YllD9XbLkQo/VLLqZGWkXEI/AAAAAAAABL0/_sEnHGrFBjA/s1600/observed%2Bvs%2Bpredicted.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://2.bp.blogspot.com/-YllD9XbLkQo/VLLqZGWkXEI/AAAAAAAABL0/_sEnHGrFBjA/s1600/observed%2Bvs%2Bpredicted.png" height="312" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Observed vs Predicted Values</td></tr></tbody></table><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: left;">As another exercise to evaluate the residuals in the model a few more charts were created below:</div><div class="separator" style="clear: both; text-align: center;"><br /></div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-6WKJ5Ez5hhs/VLQI7xUQzfI/AAAAAAAABVM/t2-S1TZYn-4/s1600/residuals%2Bv%2Bpredicted.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://4.bp.blogspot.com/-6WKJ5Ez5hhs/VLQI7xUQzfI/AAAAAAAABVM/t2-S1TZYn-4/s1600/residuals%2Bv%2Bpredicted.png" height="312" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Above: Residuals versus Predicted Values</td></tr></tbody></table><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a target="_blank" href="http://4.bp.blogspot.com/-qdjy_fCwRY0/VLQI73RH5hI/AAAAAAAABVQ/Uh2ogZNE7vw/s1600/residuals%2Bv%2Bobserved.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://4.bp.blogspot.com/-qdjy_fCwRY0/VLQI73RH5hI/AAAAAAAABVQ/Uh2ogZNE7vw/s1600/residuals%2Bv%2Bobserved.png" height="312" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Above: Residuals versus Observed Values</td></tr></tbody></table><br /><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="MsoNormal"><br /></div><div class="MsoNormal">It should be noted that home prices over $1 million were excluded from the data within the model . &nbsp;Excluding these outliers made it easier to evaluate the plotted residuals contained within the appendices.&nbsp; It was also easier to predict home sale prices overall as these high dollar value sales skewed the model for the rest of the data.&nbsp;</div><div class="MsoNormal"><br /></div><div class="MsoNormal"><o:p></o:p></div><div class="MsoNormal">After the model was completed&nbsp; the residual errors were mapped out in GIS and ran through the Moranâ€™s I tool in ArcMap to determine whether they were clustered, in which case another variable probably existed that could improve the model, or if the errors were dispersed randomly across the city.<o:p></o:p></div><div class="MsoNormal"><br /></div><br /><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"><br /></div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: 1em; margin-right: 1em; text-align: center;"><tbody><tr><td style="text-align: center;"><a target="_blank" href="http://4.bp.blogspot.com/-CVxsN1rn1zE/VLLuZh7jYzI/AAAAAAAABMQ/hhD2O2zT55g/s1600/map%2Bof%2Bresiduals.jpg" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://4.bp.blogspot.com/-CVxsN1rn1zE/VLLuZh7jYzI/AAAAAAAABMQ/hhD2O2zT55g/s1600/map%2Bof%2Bresiduals.jpg" height="400" width="308" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">The map above is useful to just visualize the spatial arrangement of residuals. &nbsp;As later confirmed by the Moran's I test, residual errors were not significantly clustered or dispersed.</td></tr></tbody></table><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a target="_blank" href="http://3.bp.blogspot.com/-qTHf4Ib2Gwc/VLLpaF-ou0I/AAAAAAAABLc/zD0QrSD14FQ/s1600/randomValues.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://3.bp.blogspot.com/-qTHf4Ib2Gwc/VLLpaF-ou0I/AAAAAAAABLc/zD0QrSD14FQ/s1600/randomValues.png" height="290" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;"><br /></td></tr></tbody></table><div class="separator" style="clear: both; text-align: center;"><span style="font-size: 13px;">Shown are the output results from the Moran's I tool. &nbsp;As shown, the model's residual errors are spatially random.</span></div><div class="separator" style="clear: both; text-align: center;"><span style="font-size: 13px;"><br /></span></div><div class="separator" style="clear: both; text-align: center;"><span style="font-size: 13px;"><br /></span></div><div class="separator" style="clear: both; text-align: center;"><span style="font-size: 13px;"><br /></span></div><div class="separator" style="clear: both; text-align: center;"><span style="font-size: 13px;"><br /></span></div><div class="separator" style="clear: both; text-align: left;">Here is one more map the depicts the values predicted within a test set. &nbsp;If you are familiar with Philadelphia, you'll notice that the higher home values in dark blue, correlate with Center City and Chestnut Hill. &nbsp;Both of which are desirable areas to live. &nbsp;The areas in red also do correspond with lower income neighborhoods such as North Philly and areas of Southwest and West Philadelphia.</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a target="_blank" href="http://2.bp.blogspot.com/-_804Aconz1o/VLLxoLwov1I/AAAAAAAABMw/gmOtd4Is_IE/s1600/prices.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-_804Aconz1o/VLLxoLwov1I/AAAAAAAABMw/gmOtd4Is_IE/s1600/prices.jpg" height="400" width="308" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><br /></div>
